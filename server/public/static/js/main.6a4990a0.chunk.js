(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,n){e.exports={SheetImageHintLabel:"SheetSelector_SheetImageHintLabel__39YhQ"}},172:function(e,t,n){},197:function(e,t,n){},236:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(21),s=n.n(r),i=(n(172),n(173),n(174),n(175),n(57)),o=n(12),l=(n(197),n(1)),j=function(e){var t=e.children;return Object(l.jsxs)("div",{children:[Object(l.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:Object(l.jsxs)("div",{className:"container-fluid",children:[Object(l.jsx)(i.b,{className:"navbar-brand",to:"/",children:"Home"}),Object(l.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(l.jsx)("span",{className:"navbar-toggler-icon"})}),Object(l.jsx)("div",{className:"collapse navbar-collapse",id:"navbarNavDropdown",children:Object(l.jsxs)("ul",{className:"navbar-nav",children:[Object(l.jsx)("li",{className:"nav-item",children:Object(l.jsx)(i.b,{className:"nav-link active","aria-current":"page",to:"/tickets/book",children:"Book Ticket"})}),Object(l.jsx)("li",{className:"nav-item",children:Object(l.jsx)(i.b,{className:"nav-link active","aria-current":"page",to:"/tickets/list",children:"List Tickets"})})]})})]})}),Object(l.jsx)("div",{className:"container-fluid mt-3",children:t})]})},b=n(11),d=n(84),u=n.n(d);u.a.defaults.baseURL="",u.a.interceptors.request.use((function(e){return console.log("Request Interceptor: ".concat(e.method,": ").concat(e.url)),e})),u.a.interceptors.response.use((function(e){return console.log("Response Interceptor:",e&&e.data),e}));var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=new Date(e),c=n.toLocaleDateString("US-en",{month:"2-digit",year:"numeric",day:"2-digit"}).split("/"),a=Object(b.a)(c,3),r=a[0],s=a[1],i=a[2];return"".concat(i).concat(t).concat(s).concat(t).concat(r)},O=n(253),m=n(258);var x=function(e){var t=e.open,n=e.title,a=e.onClose,r=e.children,s=function(){return a&&a()};return Object(l.jsx)(c.Fragment,{children:Object(l.jsxs)(O.a,{show:t,onHide:s,children:[Object(l.jsx)(O.a.Header,{closeButton:!0,children:Object(l.jsx)(O.a.Title,{children:n||"Message"})}),Object(l.jsx)(O.a.Body,{children:r}),Object(l.jsx)(O.a.Footer,{children:Object(l.jsx)(m.a,{variant:"dark",onClick:s,children:"Close"})})]})})},f=n(53),v=n(31),g=n(8),p=n(255),S=n(254),k=n(256),N=n(116),w=n(150);function C(e){return new Array(e).fill().map((function(e,t){return t}))}var D=function(e){var t=e.selectedSheets,n=e.bookedSheets,a=e.numberOfSheetsInLeftSide,r=e.numberOfSheetsInRightSide,s=e.onSheetClick?e.onSheetClick:function(){console.error("OnSheetClicked have not implemented")},i="/sheet.png",o="/bookedsheet.png",j="/check.png",d=Object(c.useState)({}),u=Object(b.a)(d,2),h=u[0],O=u[1],m=Object(c.useState)({}),x=Object(b.a)(m,2),f=x[0],v=x[1];Object(c.useEffect)((function(){if(Array.isArray(t)||Array.isArray(n)){var e=n.reduce((function(e,t){var n=t.series,c=t.number;return e["".concat(n+c)]={series:n,number:c},e}),{}),c=t.reduce((function(e,t){var n=t.series,c=t.number;return e["".concat(n+c)]={series:n,number:c},e}),{});O(c),v(e)}}),[n,t]);var g=Object(c.useState)({leftRow:[],rightRow:[]}),S=Object(b.a)(g,2),k=S[0],D=S[1],y=Object(c.useState)(C(30).map((function(e,t){return t>=26?String.fromCharCode(65)+String.fromCharCode(65+t-26):String.fromCharCode(65+t)}))),I=Object(b.a)(y,1)[0];Object(c.useEffect)((function(){var e=[],t=[];I.forEach((function(n){var c=C(a).map((function(e,t){return{name:"".concat(n).concat(t+1),series:n,number:t+1}})),s=C(r).map((function(e,t){return{name:"".concat(n).concat(t+1+a),series:n,number:t+1+a}}));e.push(c),t.push(s)})),D({leftRow:e,rightRow:t})}),[I]);var B=function(e,t){return Object(l.jsx)("img",{className:"rounded mx-auto d-block ".concat(t),height:"30px",src:e})},L=function(e){var t=e.name;return!!f[t]},A=function(e){var t=e.name;return!!h[t]},R=function(e){e.name;var t=e.series,n=e.number;s({series:t,number:n})};return Object(l.jsxs)("div",{className:"",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("hr",{}),Object(l.jsx)(F,{}),Object(l.jsx)("hr",{}),Object(l.jsx)("h4",{className:"",children:"Select Sheets"}),Object(l.jsx)("hr",{})]}),Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col  rounded",children:k.leftRow.map((function(e,t){return Object(l.jsx)("div",{className:"row",children:e.map((function(e,t){return Object(l.jsx)(E,{sheet:e},t)}))},t)}))}),Object(l.jsx)("div",{className:"col-2",children:Object(l.jsx)("div",{className:"row",children:I.map((function(e,t){return Object(l.jsx)("div",{className:"p-2 col-12 text-center",children:B("/down.png",t%3===0?"visible":"invisible")},t)}))})}),Object(l.jsx)("div",{className:"col rounded",children:k.rightRow.map((function(e,t){return Object(l.jsx)("div",{className:"row",children:e.map((function(e,t){return Object(l.jsx)(E,{sheet:e},t)}))},t)}))})]})]});function E(e){var t=e.sheet;return Object(l.jsx)(c.Fragment,{children:A(t)?Object(l.jsx)("div",{className:"col p-2 hand",onClick:function(){return R(t)},children:B(j)}):L(t)?Object(l.jsx)("div",{className:"col p-2 blocked",onClick:function(){return R(t)},title:"Booked!",children:B(o)}):Object(l.jsx)("div",{className:"col p-2 hand",onClick:function(){return R(t)},children:B(i)})},Object(w.generate)())}function F(){return Object(l.jsxs)(p.a,{className:"row",children:[Object(l.jsx)("div",{className:"col mt-2",children:Object(l.jsx)("p",{style:{verticalAlign:"center"},children:Object(l.jsxs)("span",{className:"".concat(N.SheetImageHintLabel),children:["Selected ",Object(l.jsx)("img",{src:j})]})})}),Object(l.jsx)("div",{className:"col mt-2",children:Object(l.jsx)("p",{style:{verticalAlign:"center"},children:Object(l.jsxs)("span",{className:"".concat(N.SheetImageHintLabel),children:["Available ",Object(l.jsx)("img",{src:i})]})})}),Object(l.jsx)("div",{className:"col mt-2",children:Object(l.jsx)("p",{style:{verticalAlign:"center"},children:Object(l.jsxs)("span",{className:"".concat(N.SheetImageHintLabel),children:["Booked",Object(l.jsx)("img",{src:o})]})})})]})}};D.defaultProps={selectedSheets:[],bookedSheets:[],numberOfSheetsInLeftSide:3,numberOfSheetsInRightSide:3};var y=function(e){var t=Object(c.useContext)(B).bookings,n=e.selectedSheets,a=e.onSheetUnSelect,r=e.onSheetSelect,s=e.bookedSheetByUser,i=e.showMessage,o=Object(c.useState)([]),j=Object(b.a)(o,2),d=j[0],u=j[1];Object(c.useEffect)((function(){if(t.length){var e=t.reduce((function(e,t){return[].concat(Object(f.a)(e),Object(f.a)(t.sheets))}),[]);u(e)}else u([])}),[t]);return Object(l.jsx)(D,{bookedSheets:d,selectedSheets:n,onSheetClick:function(e){if(!(d.findIndex((function(t){var n=t.series,c=t.number;return e.series===n&&e.number===c}))>-1)){var t=n.findIndex((function(t){var n=t.series,c=t.number;return e.series===n&&e.number===c}));if(t>-1)a(e,t);else{var c=n.length;if(6!==c)return c+s>=6?i("Message","Already Booked ".concat(s," sheets, You can only select ").concat(6-s)):void r(e,!0);alert("Cant select more then 6")}}}})},I=function(e){var t=Object(c.useContext)(B),n=t.selectedDate,a=t.setSelectedDate,r=t.resetBookings,s=Object(c.useState)([]),i=Object(b.a)(s,2),j=i[0],d=i[1],h=Object(c.useState)(0),O=Object(b.a)(h,2),m=O[0],N=O[1],w=Object(c.useState)({open:!1}),C=Object(b.a)(w,2),D=C[0],I=C[1],L=Object(c.useState)(null),A=Object(b.a)(L,2),R=A[0],E=A[1],F=(Object(o.f)(),Object(c.useState)({date:n,mobile:""})),T=Object(b.a)(F,2),H=T[0],P=T[1];Object(c.useEffect)((function(){var e=H.mobile,t=H.date;N(0),E(null),t&&e&&e.trim().length>9&&function(e,t){return u.a.get("/api/bookings/".concat(e,"/").concat(new Date(t).toISOString(),"/count")).then((function(e){return e&&e.data}))}(e,t).then((function(e){var t=e.sheetBooked;if(console.log({sheetBooked:t}),N(t),t>=6)return E("Already Booked ".concat(t," Sheets On Selected Date."));E(null)}))}),[H]),Object(c.useEffect)((function(){P(Object(g.a)(Object(g.a)({},H),{},{date:n}))}),[n]);var U=function(e){r();var t=e.target,n=t.name,c=t.value;if("date"===n)return a(c);P(Object(g.a)(Object(g.a)({},H),{},Object(v.a)({},n,c)))};return Object(l.jsxs)("div",{className:"m-4",id:"form",children:[R&&Object(l.jsx)(p.a,{color:"yellow",children:R}),Object(l.jsx)(x,{open:D.open,title:D.title,onClose:function(){return I({open:!1})},children:D.content}),Object(l.jsxs)(S.a,{onSubmit:function(){if(!j.length)return window.scrollTo({top:0}),E("Select Sheets");if(!H.mobile.trim())return window.scrollTo({top:0}),E("Enter Phone");var e,t={mobile:H.mobile,date:H.date,sheets:j};(e=t,u.a.post("/api/bookings",e).then((function(e){return e&&e.data}))).then((function(e){var t=e.booking;d([]),r(),I({open:!0,title:"Ticket Booked",content:Object(l.jsxs)("div",{children:[Object(l.jsxs)("p",{children:["Booking Id: ",t.bookingId]}),Object(l.jsxs)("p",{children:["Mobile Number: ",t.mobile]}),Object(l.jsxs)("p",{children:["Sheets:"," ",t.sheets.map((function(e){return"".concat(e.series).concat(e.number)})).join(", ")]})]})})})).catch((function(e){console.log(e);var t=e.response.data;E(t.error)}))},children:[Object(l.jsxs)(S.a.Field,{children:[Object(l.jsx)("label",{children:"Mobile Number"}),Object(l.jsx)("input",{value:H.mobile,onChange:U,placeholder:"Mobile",type:"number",name:"mobile"})]}),Object(l.jsxs)(S.a.Field,{children:[Object(l.jsx)("label",{children:"Date"}),Object(l.jsx)("input",{placeholder:"Date",type:"date",name:"date",value:H.date,onChange:U})]}),Object(l.jsx)(y,{selectedSheets:j,onSheetSelect:function(e){return d([].concat(Object(f.a)(j),[e]))},bookedSheetByUser:m,showMessage:function(e,t){I({open:!0,title:e,content:t})},onSheetUnSelect:function(e,t){var n=Object(f.a)(j);n.splice(t,1),d(n)}}),Object(l.jsx)("hr",{}),Object(l.jsx)(k.a,{color:"black",type:"submit",children:"Submit"})]})]})},B=a.a.createContext(),L=function(e){console.log(h(new Date));var t=Object(c.useState)(h(new Date)),n=Object(b.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)([]),i=Object(b.a)(s,2),o=i[0],j=i[1],d=function(){(function(e){var t=new URLSearchParams({date:new Date(e).toISOString()}).toString();return u.a.get("/api/bookings?".concat(t)).then((function(e){return e&&e.data}))})(a).then((function(e){var t=e.bookings;j(t)}))},O={bookings:o,selectedDate:a,setSelectedDate:r,resetBookings:d};return Object(c.useEffect)((function(){j([]),console.log("DATE CHANGED>>."),d()}),[a]),Object(l.jsx)(B.Provider,{value:O,children:Object(l.jsx)("div",{className:"col-lg-6 col-md-8 mx-auto shadow rounded py-4",children:Object(l.jsx)(I,{})})})},A=function(e){var t=Object(c.useState)([]),n=Object(b.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(h(new Date)),i=Object(b.a)(s,2),o=i[0],j=i[1];Object(c.useEffect)((function(){(function(e){e&&e.date&&(e.date=new Date(e.date));var t="/api/bookings/time-optimized-list?".concat(new URLSearchParams(e).toString());return u.a.get(t).then((function(e){return e.data}))})({date:o}).then((function(e){r(e)}))}),[o]);return Object(l.jsx)("div",{children:Object(l.jsxs)("div",{className:"col-lg-7 mx-auto",children:[Object(l.jsx)("h4",{className:"display-6",children:"Bookings "}),Object(l.jsx)(S.a,{children:Object(l.jsxs)(S.a.Field,{children:[Object(l.jsx)("label",{children:"Date"}),Object(l.jsx)("input",{placeholder:"Date",type:"date",name:"date",value:o,onChange:function(e){var t=e.target,n=(t.name,t.value);j(n)}})]})}),Object(l.jsx)("hr",{}),Object(l.jsxs)("table",{className:"table table-bordered table-hover table-striped",children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"#"}),Object(l.jsx)("th",{children:"Booking Id"}),Object(l.jsx)("th",{children:"Date"}),Object(l.jsx)("th",{children:"Sheets"}),Object(l.jsx)("th",{children:"Phone"})]})}),Object(l.jsx)("tbody",{children:a.map((function(e,t){return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:t+1}),Object(l.jsx)("td",{children:e.bookingId}),Object(l.jsx)("td",{children:new Date(e.date).toDateString()}),Object(l.jsx)("td",{children:e.sheets.map((function(e){return"".concat(e.series).concat(e.number)})).join(", ")}),Object(l.jsx)("td",{children:Object(l.jsx)("a",{style:{textDecoration:"none"},href:"tel:".concat(e.mobile),target:"_blank",children:"\ud83d\udcde"})})]},t)}))})]})]})})};var R=function(){return Object(l.jsx)(i.a,{children:Object(l.jsx)(j,{children:Object(l.jsxs)(o.c,{children:[Object(l.jsx)(o.a,{path:["/","/tickets/book"],exact:!0,children:Object(l.jsx)(L,{})}),Object(l.jsx)(o.a,{path:"/tickets/list",exact:!0,children:Object(l.jsx)(A,{})})]})})})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,259)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.render(Object(l.jsx)(c.Fragment,{children:Object(l.jsx)(R,{})}),document.getElementById("root")),E()}},[[236,1,2]]]);
//# sourceMappingURL=main.6a4990a0.chunk.js.map